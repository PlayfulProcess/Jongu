<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your Story (Beta) - Jongu Kids Books</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1DB954;
            --secondary-color: #FFD700;
            --accent-color: #4A90E2;
            --text-color: #333;
            --light-text: #fff;
            --background-color: #F0F4F8;
            --section-bg: #fff;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .prototype-notice {
            max-width: 700px;
            margin: 24px auto 0 auto;
            padding: 1.5rem 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: var(--border-radius);
            color: #fff;
            box-shadow: var(--box-shadow);
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            /* Two columns for larger screens */
            column-count: 2;
            column-gap: 2.5rem;
        }
        .prototype-notice ul, .prototype-notice ol {
            margin-left: 1.5em;
            padding-left: 1.2em;
            color: #fff;
            /* Ensure bullets/numbers are visible */
            list-style-position: inside;
        }
        .prototype-notice li {
            margin-bottom: 0.5em;
        }
        @media (max-width: 700px) {
            .prototype-notice {
            column-count: 1;
            }
        }
    

    /* ...rest of existing styles... */

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .container {
            display: flex;
            height: 100vh;
            padding: 20px;
            gap: 20px;
        }

        .panel {
            background: var(--section-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            overflow-y: auto;
        }

        #pageList {
            flex: 1;
            min-width: 250px;
        }

        #preview {
            flex: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #chatInterface {
            flex: 1;
            min-width: 300px;
        }

        .page-item {
            background: white;
            border: 1px solid #eee;
            border-radius: var(--border-radius);
            padding: 10px;
            margin-bottom: 10px;
            cursor: move;
        }

        .page-item img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }

        .preview-content {
            width: 100%;
            max-width: 600px;
            text-align: center;
        }

        .preview-content img {
            max-width: 100%;
            height: auto;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .preview-content textarea {
            width: 100%;
            min-height: 100px;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-family: inherit;
        }

        .btn {
            background-color: var(--secondary-color);
            color: var(--text-color);
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #e6c300;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #169c46;
        }

        #chatFrame {
            width: 100%;
            height: calc(100% - 40px);
            border: none;
            border-radius: var(--border-radius);
        }

        .header {
            text-align: center;
            padding: 20px;
            background-color: var(--accent-color);
            color: white;
        }

        .header h1 {
            margin: 0;
            font-size: 2rem;
        }

        .header p {
            margin: 10px 0 0;
            opacity: 0.9;
        }

        .back-link {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            font-weight: 500;
        }

        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="../../kids_books.html" class="back-link">‚Üê Back to Books</a>
        <div class="header-content">
            <h1>Create Your Story <span class="prototype-label">PROTOTYPE</span></h1>
            <p class="subtitle">Talk to the assistant, preview your pages, and build your book!</p>
            
            <div class="prototype-notice">
                <h3>üöß Development Prototype - Local OpenAI Only</h3>
                <p><strong>‚ö†Ô∏è This version requires local setup and is not cloud-deployed yet.</strong></p>
                
                <p><strong>Requirements:</strong></p>
                <ul>
                    <li>Local Python FastAPI server running</li>
                    <li>Valid OpenAI API key in .env file</li>
                    <li>Dependencies installed locally</li>
                </ul>

                <p><strong>üìÇ GitHub Repository:</strong><br>
                <a href="https://github.com/PlayfulProcess/Jongu" target="_blank">https://github.com/PlayfulProcess/Jongu</a></p>
                
                <p><strong>üöÄ Quick Setup Instructions:</strong></p>
                <ol>
                    <li>Clone: <code>git clone https://github.com/PlayfulProcess/Jongu.git</code></li>
                    <li>Navigate: <code>cd Jongu/kids_books/builder/</code></li>
                    <li>Create .env file with: <code>OPENAI_API_KEY=your-key-here</code></li>
                    <li>Install: <code>pip install -r requirements.txt</code></li>
                    <li>Run server: <code>uvicorn main:app --host 127.0.0.1 --port 8000 --reload</code></li>
                    <li>Open index.html in your browser</li>
                </ol>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="pageList" class="panel" style="flex: 0.8; min-width: 200px;">
            <h2>Your Pages</h2>
            <div id="pagesContainer">
                <!-- Pages will be added here dynamically -->
            </div>
            <button id="exportBtn" class="btn btn-primary" style="width: 100%; margin-top: 20px;">
                Export Book
            </button>
        </div>

        <div id="preview" class="panel" style="flex: 1.2; max-width: 500px;">
            <h2>Preview</h2>
            <div class="preview-content">
                <img id="previewImage" src="" alt="Preview" style="display: none;">
                <div style="margin-bottom: 10px; color: #666; font-size: 0.98em;">Edit your story text and image prompt below. Click 'Generate Image' to create an illustration, and 'Save Page' to add it to your book.</div>
                <textarea id="previewText" placeholder="Your story text will appear here..." style="margin-bottom: 10px;"></textarea>
                <textarea id="imagePrompt" placeholder="Type image prompt here" style="margin-bottom: 10px;"></textarea>
                <div id="previewActions" style="display: flex; flex-direction: column; align-items: center; gap: 14px; margin-bottom: 10px;">
                    <button id="generateImageBtn" class="btn btn-primary">Generate Image</button>
                    <button id="savePageBtn" class="btn">Save Page</button>
                </div>
                <div style="margin-top: 12px; color: #888; font-size: 0.98em; text-align: center; max-width: 400px;">
                    <strong>Pro tip:</strong> Sometimes the text in the image is wrong or the style isn't quite right. You can specify corrections or style preferences directly in the image prompt (e.g., "make the text say..." or "draw in watercolor style"). Hopefully, new models will be better with text, but for now, this is the main workaround!
                </div>
            </div>
        </div>

        <div id="chatInterface" class="panel" style="flex: 1.5; min-width: 400px;">
            <h2>Chat with GPT-4.0</h2>
            <div id="chatMessages" style="height: 350px; overflow-y: auto; background: #f7f7f7; border-radius: 8px; padding: 10px; margin-bottom: 10px;"></div>
            <form id="chatForm" style="display: flex; gap: 8px;">
                <textarea id="chatInput" rows="2" placeholder="Type your message..." style="flex: 1; border-radius: 8px; border: 1px solid #ccc; padding: 8px;"></textarea>
                <button type="submit" class="btn btn-primary">Send</button>
            </form>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html> 
